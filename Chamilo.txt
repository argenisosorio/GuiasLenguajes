====================================================
Guía de Instalación y Configuración de Chamilo by dM
====================================================

Chamilo LMS es un sistema de gestión de aprendizaje o LMS (Learning Management
System), diseñado para apoyar a la educación en línea.  Es una plataforma de
software libre escrita en PHP, cuyo propósito es mejorar la educación y su
acceso a ella a nivel mundial.  Este software gratuito es fruto de la
colaboración de varias empresas, organizaciones e individuos de acuerdo con el
modelo de código abierto bajo estrictos valores éticos. Se distribuye bajo la
Licencia Pública General de GNU/GPLv3.4​ Este tipo de licencias para software
está destinada a garantizar la libertad para compartir y cambiar todas las
versiones de un programa, lo cual asegura que sea gratuito para todos sus
usuarios, permitiendo instalar, modificar y crear elementos complementarios para
poder adaptarse a las necesidades específicas de cada proyecto de e-learning.
Es por este motivo, por el que sus creadores escogieron el nombre Chamilo, que
surge del diminutivo de la expresión en inglés Chameleon.

Fuente
======

https://es.wikipedia.org/wiki/Chamilo

====
Nota
====

Usaremos $ para describir los comandos que se usaran con usuario regular.

Usaremos # para describir los comandos que se usaran con superusuario.

========================================================
Instalar, configurar y crear una base de datos con MySQL
========================================================

Actualizamos los repositorios

# apt-get update

Instalar MySQL server

# apt-get install mysql-server

Por la consola nos pedira una contraseña para el usuario root de mysql.

Acceder a la consola de mysql, nos pedirá la contraseña solamente.

# mysql -p

Crear una base de datos.

mysql> create database chamilo;

Crear un usuario y su contraseña.

mysql> create user 'admin'@'localhost' identified by '123456';

Darle permisos al usuario creado sobre una db existente.

mysql> grant all on chamilo.* to 'admin';

Listas las bases de datos disponibles.

mysql> show databases;

=========================================================
Manual de instalación de Chamilo 1.11.32 en entorno local
=========================================================

Notas:

Repositorio oficial de la v1.11.32: ​https://github.com/chamilo/chamilo-lms/tree/v1.11.32
Guía de Instalación oficial de Chamilo 1.11: ​https://11.chamilo.org/documentation/installation_guide_es_ES.html
Usaremos $ para describir los comandos que se ejecutaran con un usuario regular.
Usaremos # para describir los comandos que se ejecutaran con un super usuario.
Usaremos > para describir los comandos que se ejecutaran en la consola de MariaDB. 


Requisitos del Sistema Operativo

GNU/Linux Debian 13
Git (La versión que esté disponible) ​Cómo instalar Git
Apache v2.x ​Cómo instalar Apache
MariaDB (La versión que esté disponible) ​Cómo instalar MariaDB.
PHP v7.4 ​Cómo instalar PHP 


1. Instalación de Apache Http Sever

$ sudo apt install apache2

Esto creara el directorio /var/www/html/

2. Instalación de PHP 7.4

Configurar repositorio de PHP Sury

$ sudo apt-get install apt-transport-https lsb-release ca-certificates

$ sudo wget -O /etc/apt/trusted.gpg.d/php.gpg https://packages.sury.org/php/apt.gpg

$ echo "deb https://packages.sury.org/php/ $(lsb_release -sc) main" | sudo tee /etc/apt/sources.list.d/php.list

$ sudo apt-get update

Solución de problemas con firma GPG

Si encuentras errores relacionados con la firma GPG, ejecuta:

$ sudo wget -O /etc/apt/trusted.gpg.d/php.gpg https://packages.sury.org/php/apt.gpg

$ sudo apt-get update

Instalar PHP 7.4

$ sudo apt-get install php7.4

Verificar instalación

$ php -v

El comando debe mostrar información de PHP 7.4 si la instalación fue exitosa.

3. Configuración de Base de Datos MariaDB

Instalar MariaDB

$ sudo apt update

$ sudo apt install mariadb-server

Verificar instalación

$ mysql -V

Configurar usuario y base de datos

Accede a la consola de MariaDB:

$ sudo mysql -u root

Ejecuta los siguientes comandos dentro de la consola MariaDB:

Crear usuario específico para Chamilo

> CREATE USER 'chamilo'@'localhost' IDENTIFIED BY '123456';

Crear base de datos

> CREATE DATABASE chamilo;

Asignar privilegios completos al usuario

> GRANT ALL PRIVILEGES ON chamilo.* TO 'chamilo'@'localhost';

Aplicar cambios de privilegios

> FLUSH PRIVILEGES;

4. Descarga del Código Fuente

Clonar repositorio oficial

$ git clone -b 1.11.x --single-branch https://github.com/chamilo/chamilo-lms.git chamilo-1.11

Tras una clonación exitosa, se creará el directorio chamilo-1.11.

5. Preparación del Entorno Web

Configurar permisos del directorio web

$ sudo chmod -R 777 /var/www/html/

Mover y configurar Chamilo

Mover a directorio web

$ mv chamilo-1.11 /var/www/html/

Renombrar directorio

$ mv /var/www/html/chamilo-1.11 /var/www/html/chamilo

Ajustar permisos y propiedad

$ sudo chmod -R 777 /var/www/html/chamilo

$ sudo chown -R www-data:www-data /var/www/html/chamilo/

$ sudo chmod -R 755 /var/www/html/chamilo/

6. Instalación de Extensiones PHP Requeridas

Instalar dependencias PHP necesarias

$ sudo apt install php7.4 php7.4-fpm php7.4-common php7.4-sqlite3 php7.4-curl php7.4-intl php7.4-mbstring php7.4-xmlrpc php7.4-mysql php7.4-gd php7.4-xml php7.4-cli php7.4-ldap php7.4-apcu php7.4-zip php7.4-json php7.4-tokenizer libapache2-mod-php7.4 php7.4-bcmath php7.4-soap

7. Configuración de PHP

Verificación de ruta del archivo php.ini

Crear el archivo testphp.php

$ nano /var/www/html/testphp.php

Agrega las lineas siguientes al archivo y guárdalo:

<?php
// Muestra toda la información, por defecto INFO_ALL
phpinfo();
?>

Para ver este archivo abre tu navegador web y teclea la IP de tu servidor seguido del archivo que acabas de crear, por ejemplo: ​http://127.0.0.1/testphp.php

Si aparece la pagina azul pastel de PHP donde muestra detalles de la versión, etc, entonces se instalo correctamente además podrás ver la ruta exacta del archivo php.ini que está usando el Apache.

Ajustar parámetros en php.ini

Edita el archivo /etc/php/7.4/apache2/php.ini o bien en la ruta que indique el archivo testphp.php en pantalla con los siguientes valores:

max_execution_time = 300
max_input_time = 600
memory_limit = 256M
post_max_size = 100M
upload_max_filesize = 100M
short_open_tag = Off
session.cookie_httponly = on
date.timezone = "America/Caracas"

Aplicar cambios

$ sudo systemctl reload apache2.service

8. Configuración de Apache

Habilitar módulo rewrite

$ sudo /usr/sbin/a2enmod rewrite

$ sudo systemctl reload apache2.service

Modificar configuración principal

Edita /etc/apache2/apache2.conf y asegúrate de que estas secciones tengan la siguiente configuración:

<Directory />
    Options FollowSymLinks
    AllowOverride All
    Require all granted
</Directory>

<Directory /usr/share>
    AllowOverride None
    Require all granted
</Directory>

<Directory /var/www/>
    Options Indexes FollowSymLinks
    AllowOverride All
    Require all granted
</Directory>

Aplicar cambios

$ sudo systemctl reload apache2.service

Crear configuración específica para Chamilo

Crea el archivo /etc/apache2/conf-available/htaccessForChamilo.conf con este contenido:

<Directory /var/www/html/chamilo>
    AllowOverride All
</Directory>

Habilitar y aplicar configuración

$ sudo a2enconf htaccessForChamilo

$ sudo systemctl restart apache2.service


9. Instalación de Composer

Descargar e instalar Composer

$ php -r "readfile('https://getcomposer.org/installer');" | php

$ sudo mv composer.phar /usr/local/bin/composer

Verificar instalación

$ composer

Solución alternativa para enlace simbólico

Si el comando anterior muestra error, crea un enlace simbólico:

$ sudo ln -s /usr/local/bin/composer /usr/bin/composer


10. Instalación de Dependencias de Chamilo

Preparar entorno de Chamilo

$ cd /var/www/html/chamilo

$ composer config --global audit.block-insecure false

Instalar dependencias

$ composer install --no-dev --optimize-autoloader

Otorgar permisos a los nuevos directorios creados

$ sudo chmod -R 777 /var/www/html/chamilo


11. Instalación por Interfaz Web

Acceder al instalador

Abre tu navegador web, visita: ​http://127.0.0.1/chamilo

Selecciona el idioma de instalación preferido y darle a Siguiente 

Fuente
======

https://apropiacion.cenditel.gob.ve/cursos/wiki/migracion-chamilo-lms/man-inst-1-11-32-ent-dev

=========================
Instalación usando Apache
=========================

Instalamos apache.

# apt-get install apache2

====================================================
Instalación de PHP y los módulos de PHP+MySQL+Apache
====================================================

Instalación antigua NO RECOMENDADA

Instalamos php, en este caso el 5
# apt-get install php5 php5-gd php5-mysql libapache2-mod-php5 php5-intl
php5-curl php5-json

Copiamos la carpeta de chamilo en /var/www/html

Editamos el fichero php.ini, la ubicaión del es /etc/php5/apache2/php.ini
Modificamos el valor de las variables

max_execution_time = 300 ;Maximum execution time of each script, in seconds
max_input_time = 600 ;Maximum amount of time each script may spend parsing request data
memory_limit = 256M ;Maximum amount of memory a script may consume (128MB)
post_max_size = 100M
upload_max_filesize = 100M;
short_open_tag = Off
safe_mode = Off
magic_quotes_gpc = Off
magic_quotes_runtime = Off
session.cookie_httponly = on
date.timezone = "America/Caracas"

Guardamos el fichero php.ini y reiniciamos apache

# systemctl restart apache2

La versión que se uso para la elaboración de este manual es la Chamilo 1.10.x
por tanto se deben hacer unas configuraciones extras de Apache para
que todo funcione bien.
Vamos a activar el modulo rewrite de Apache con el siguiente comando:

# a2enmod rewrite

# systemctl restart apache2

Ahora modificamos el fichero /etc/apache2/apache2.conf buscamos el
siguiente bloque y cambiamos el valor de AllowOverride de None por All.

<Directory /var/www/>
  Options Indexes FollowSymLinks
  AllowOverride All
  Require all granted
</Directory>

Guardamos el fichero y luego reiniciamos apache con:

# systemctl restart apache2

Ahora accedemos a 127.0.0.1/chamilo desde el navegador para ver la plataforma.
Ya desde el navegador nos pedira algunos datos y tendremos que pulsar algunos
botones: Nos pide el idioma de instalación, luego checkea los requerimientos,
ahora pulsamos "Nueva instalación" Aceptamos la licencia, ahora escribimos el
nombre de la base de datos, el usuario y la contraseña que configuramos con
anterioridad, ahora rellenamos los Parámetros de configuración, como: usuario
administrador de la plataforma, la contraseña, nombres y apellidos así como
email Una vez hecho todo eso ya podremos acceder a la pantalla del login de la
plataforma en http://127.0.0.1/chamilo/index.php y autenticarnos con el usuario
creaado en la instalación.

=============================================
Configurar la base de datos, rutas, ip, otras
=============================================

El fichero de configuración de la base de datos está en:

chamilo/app/config/configuration.php

En este fichero también podemos configurar la ruta absoluta del código
fuente y la ip por donde va a ser servido el proyecto.

========================
Instalación usando Nginx
========================

Instalamos nginx.

# apt-get install nginx

===================================================
Instalación de PHP y los módulos de PHP+MySQL+Nginx
===================================================

# apt-get install php5 php5-gd php5-mysql php5-intl php5-curl php5-json php5-fpm

faltan pruebas...

==================
Limpiando el caché
==================

Si va a cambiar las plantillas, debe saber una cosa y recordarla: después de
escribir sus cambios y antes de probarlos, deberá eliminar el contenido del
directorio app/cache/twig

De lo contrario, el caché se mantendrá y no verá ninguno (o verá solo algunos)
de sus cambios, lo que podría hacerle creer que no surtieron efecto.

Esta limpieza también se ejecuta cuando se usa la opción "Limpieza de
archivo/caché" en la pantalla de administración principal de su portal Chamilo
(bloque "Sistema").

====================
Formatos de archivos
====================

eXeLearning permite exportar las lecciones en formato .zip, llamado también
archivo scorm, es el que se sube en la plataforma chamilo, también se puede
exportar en formato .elp, este es el formato para ser leído en eXeLearning.
